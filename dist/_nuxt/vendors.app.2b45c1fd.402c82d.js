(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{344:function(t,e,r){"use strict";var n=r(52),o=r(0),h=r(2),d=function(t,b){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])},d(t,b)};function f(t,b){function e(){this.constructor=t}d(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}var c=function(t){function e(e,r,n,o){void 0===e&&(e=100),void 0===r&&(r=100),void 0===n&&(n=10),void 0===o&&(o=10);var h=t.call(this)||this;return h.segWidth=n,h.segHeight=o,h.width=e,h.height=r,h.build(),h}return f(e,t),e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],r=[],n=[],o=this.segWidth-1,h=this.segHeight-1,d=this.width/o,f=this.height/h,i=0;i<t;i++){var c=i%this.segWidth,l=i/this.segWidth|0;e.push(c*d,l*f),r.push(c/o,l/h)}var y=o*h;for(i=0;i<y;i++){var _=i%o,v=i/o|0,x=v*this.segWidth+_,m=v*this.segWidth+_+1,w=(v+1)*this.segWidth+_,P=(v+1)*this.segWidth+_+1;n.push(x,m,w,m,P,w)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint16Array(n),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(n.b),l=function(t){function e(e,r,n){void 0===e&&(e=200),void 0===n&&(n=0);var o=t.call(this,new Float32Array(4*r.length),new Float32Array(4*r.length),new Uint16Array(6*(r.length-1)))||this;return o.points=r,o._width=e,o.textureScale=n,o.build(),o}return f(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),r=this.getBuffer("aTextureCoord"),n=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),r.data=new Float32Array(4*t.length),n.data=new Uint16Array(6*(t.length-1)));var o=r.data,h=n.data;o[0]=0,o[1]=0,o[2]=0,o[3]=1;for(var d=0,f=t[0],c=this._width*this.textureScale,l=t.length,i=0;i<l;i++){var y=4*i;if(this.textureScale>0){var _=f.x-t[i].x,v=f.y-t[i].y,x=Math.sqrt(_*_+v*v);f=t[i],d+=x/c}else d=i/(l-1);o[y]=d,o[y+1]=0,o[y+2]=d,o[y+3]=1}var m=0;for(i=0;i<l-1;i++){y=2*i;h[m++]=y,h[m++]=y+1,h[m++]=y+2,h[m++]=y+2,h[m++]=y+1,h[m++]=y+3}r.update(),n.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,r=t[0],n=0,o=0,h=this.buffers[0].data,d=t.length,i=0;i<d;i++){var f=t[i],c=4*i;o=-((e=i<t.length-1?t[i+1]:f).x-r.x),n=e.y-r.y;var l=Math.sqrt(n*n+o*o),y=this.textureScale>0?this.textureScale*this._width/2:this._width/2;n/=l,o/=l,n*=y,o*=y,h[c]=f.x+n,h[c+1]=f.y+o,h[c+2]=f.x-n,h[c+3]=f.y-o,r=f}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(n.b),y=(function(t){function e(e,r,h){void 0===h&&(h=0);var d=this,f=new l(e.height,r,h),c=new n.c(e);return h>0&&(e.baseTexture.wrapMode=o.s.REPEAT),(d=t.call(this,f,c)||this).autoUpdate=!0,d}f(e,t),e.prototype._render=function(e){var r=this.geometry;(this.autoUpdate||r._width!==this.shader.texture.height)&&(r._width=this.shader.texture.height,r.update()),t.prototype._render.call(this,e)}}(n.a),function(t){function e(e,r,o){var d=this,f=new c(e.width,e.height,r,o),l=new n.c(h.q.WHITE);return(d=t.call(this,f,l)||this).texture=e,d.autoResize=!0,d}return f(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry,e=this.shader.texture,r=e.width,n=e.height;!this.autoResize||t.width===r&&t.height===n||(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},e.prototype.destroy=function(e){this.shader.texture.off("update",this.textureUpdated,this),t.prototype.destroy.call(this,e)},e}(n.a));(function(t){function e(e,r,o,d,f){void 0===e&&(e=h.q.EMPTY);var c=this,l=new n.b(r,o,d);l.getBuffer("aVertexPosition").static=!1;var y=new n.c(e);return(c=t.call(this,l,y,null,f)||this).autoUpdate=!0,c}f(e,t),Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)}})(n.a),function(t){function e(e,r,n,o,d){void 0===r&&(r=10),void 0===n&&(n=10),void 0===o&&(o=10),void 0===d&&(d=10);var f=t.call(this,h.q.WHITE,4,4)||this;return f._origWidth=e.orig.width,f._origHeight=e.orig.height,f._width=f._origWidth,f._height=f._origHeight,f._leftWidth=r,f._rightWidth=o,f._topHeight=n,f._bottomHeight=d,f.texture=e,f}f(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,r=this._topHeight+this._bottomHeight,n=this._height>r?1:this._height/r;return Math.min(e,n)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var r=1/this._origWidth,n=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=r*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-r*this._rightWidth,e[9]=e[11]=e[13]=e[15]=n*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-n*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}(y)},52:function(t,e,r){"use strict";r.d(e,"a",(function(){return m})),r.d(e,"b",(function(){return P})),r.d(e,"c",(function(){return w}));var n=r(2),o=r(3),h=r(0),d=r(15),f=r(9),c=r(4),l=function(t,b){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])},l(t,b)};function y(t,b){function e(){this.constructor=t}l(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}var _=function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var data=this.uvBuffer.data;this.data&&this.data.length===data.length||(this.data=new Float32Array(data.length)),this.uvMatrix.multiplyUvs(data,this.data),this._updateID++}},t}(),v=new o.g,x=new o.h,m=function(t){function e(e,r,o,d){void 0===d&&(d=h.f.TRIANGLES);var c=t.call(this)||this;return c.geometry=e,c.shader=r,c.state=o||n.p.for2d(),c.drawMode=d,c.start=0,c.size=0,c.uvs=null,c.indices=null,c.vertexData=new Float32Array(1),c.vertexDirty=-1,c._transformID=-1,c._roundPixels=f.b.ROUND_PIXELS,c.batchUvs=null,c}return y(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},set:function(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===h.f.TRIANGLES&&r.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;var n=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[n]),t.plugins[n].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry.buffers[0],e=t.data,r=t._updateID;if(r!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var n=this.transform.worldTransform,a=n.a,b=n.b,o=n.c,h=n.d,d=n.tx,c=n.ty,l=this.vertexData,i=0;i<l.length/2;i++){var y=e[2*i],_=e[2*i+1];l[2*i]=a*y+o*_+d,l[2*i+1]=b*y+h*_+c}if(this._roundPixels){var v=f.b.RESOLUTION;for(i=0;i<l.length;++i)l[i]=Math.round((l[i]*v|0)/v)}this.vertexDirty=r}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new _(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,v);for(var e=this.geometry.getBuffer("aVertexPosition").data,r=x.points,n=this.geometry.getIndex().data,o=n.length,h=4===this.drawMode?3:1,i=0;i+2<o;i+=h){var d=2*n[i],f=2*n[i+1],c=2*n[i+2];if(r[0]=e[d],r[1]=e[d+1],r[2]=e[f],r[3]=e[f+1],r[4]=e[c],r[5]=e[c+1],x.contains(v.x,v.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e}(d.b),w=function(t){function e(e,r){var h=this,d={uSampler:e,alpha:1,uTextureMatrix:o.d.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r)).uniforms&&Object.assign(d,r.uniforms),(h=t.call(this,r.program||n.k.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),d)||this)._colorDirty=!1,h.uvMatrix=new n.r(e),h.batchable=void 0===r.program,h.pluginName=r.pluginName,h.tint=r.tint,h.alpha=r.alpha,h}return y(e,t),Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;Object(c.w)(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(n.o),P=function(t){function e(e,r,o){var d=t.call(this)||this,f=new n.f(e),c=new n.f(r,!0),l=new n.f(o,!0,!0);return d.addAttribute("aVertexPosition",f,2,!1,h.r.FLOAT).addAttribute("aTextureCoord",c,2,!1,h.r.FLOAT).addIndex(l),d._updateId=-1,d}return y(e,t),Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e}(n.i)}}]);